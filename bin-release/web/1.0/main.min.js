var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function s(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(s.prototype=i.prototype,new s)}}(),Doll=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(egret.DisplayObjectContainer);__reflect(Doll.prototype,"Doll");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Main=function(t){function e(){var e=t.call(this)||this;return e._position=0,e._step=10,e._isRunning=!1,e._isStarting=!1,e._toys=[],e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){egret.lifecycle.addLifecycleListener(function(t){t.onUpdate=function(){}}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()},this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},e.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},e.prototype.onResourceLoadComplete=function(t){"preload"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},e.prototype.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},e.prototype.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},e.prototype.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},e.prototype.checkCollision=function(t,e){this._dot.x=t,this._dot.y=e},e.prototype.directionClick=function(t,e){var i=this;if(this._isStarting){if(this._left.hitTestPoint(t,e,!0)){if(console.log("left"),this._position<1)return;return this._position-=this._step,this._top.x-=this._step,this._line.x-=this._step,void(this._zhua.x-=this._step)}if(this._right.hitTestPoint(t,e,!0)){if(console.log("right"),this._position>410)return;return this._position+=this._step,this._top.x+=this._step,this._line.x+=this._step,void(this._zhua.x+=this._step)}if(this._btn.hitTestPoint(t,e,!0)){if(console.log("zhua"),this._isRunning)return;return this._isRunning=!0,egret.Tween.get(this._line).to({height:this._line.height+360},500,egret.Ease.sineIn).wait(100).to({height:this._line.height},500,egret.Ease.sineOut).wait(100),void egret.Tween.get(this._zhua).to({y:this._zhua.y+360},500,egret.Ease.sineIn).wait(100).call(function(){i._zhua.texture=RES.getRes("zhua2_png"),i._zhua.x+=38,i._zhua.width=107;var t=i._zhua.x+i._zhua.width/2,e=i._zhua.y+i._zhua.height,s=function(s){var h=i._toys[s];return h.hitTestPoint(t,e,!0)?(egret.Tween.get(h).to({y:h.y-360},500,egret.Ease.sineOut).wait(100).to({x:h.x-i._position},300,egret.Ease.sineIn).to({y:h.y},300,egret.Ease.sineIn).call(function(){i.removeChild(h),i._toys.splice(parseInt(s),1),0===i._toys.length&&setTimeout(function(){i._isStarting=!1,i._left.$setVisible(i._isStarting),i._right.$setVisible(i._isStarting),i._btn.$setVisible(i._isStarting),i._start.$setVisible(!i._isStarting)})}),{value:void 0}):void 0};for(var h in i._toys){var n=s(h);if("object"==typeof n)return n.value}}).to({y:this._zhua.y},500,egret.Ease.sineOut).wait(100).call(function(){i._isRunning=!1,i.back()})}}else this._start.hitTestPoint(t,e,!0)&&(this._isStarting=!0,this._left.$setVisible(this._isStarting),this._right.$setVisible(this._isStarting),this._btn.$setVisible(this._isStarting),this._start.$setVisible(!this._isStarting),this.initToy())},e.prototype.back=function(){var t=this;egret.Tween.get(this._top).to({x:this._top.x-this._position},300,egret.Ease.sineIn),egret.Tween.get(this._line).to({x:this._line.x-this._position},300,egret.Ease.sineIn),egret.Tween.get(this._zhua).to({x:this._zhua.x-this._position},300,egret.Ease.sineIn).call(function(){t._position=0,t._zhua.texture=RES.getRes("zhua1_png"),t._zhua.x-=38,t._zhua.width=183})},e.prototype.initToy=function(){for(var t=0;4>t;t++){var e=this.createBitmapByName("cartoon-egret_00_png");e.width=114,e.height=190,e.x=460-80*t,e.y=570,this.addChild(e),this._toys.push(e)}},e.prototype.touchHandler=function(t){switch(t.type){case egret.TouchEvent.TOUCH_MOVE:this.checkCollision(t.stageX,t.stageY);break;case egret.TouchEvent.TOUCH_BEGIN:this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchHandler,this),this.stage.once(egret.TouchEvent.TOUCH_END,this.touchHandler,this),this.addChild(this._dot),this.checkCollision(t.stageX,t.stageY),this.directionClick(t.stageX,t.stageY);break;case egret.TouchEvent.TOUCH_END:this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchHandler,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchHandler,this),this._dot.parent&&this._dot.parent.removeChild(this._dot)}},e.prototype.createGameScene=function(){this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchHandler,this);var t=this.createBitmapByName("bg_png");t.width=516,t.height=715,t.x=65,t.y=45,this.addChild(t),this._top=this.createBitmapByName("top_png"),this._top.width=119,this._top.height=46,this._top.x=50,this._top.y=45,this.addChild(this._top),this._line=this.createBitmapByName("line_png"),this._line.width=15,this._line.height=71,this._line.x=102,this._line.y=90,this.addChild(this._line),this._zhua=this.createBitmapByName("zhua1_png"),this._zhua.width=183,this._zhua.height=155,this._zhua.x=19,this._zhua.y=161,this.addChild(this._zhua);var e=this.createBitmapByName("doll_bg_png"),i=this.stage.stageWidth,s=this.stage.stageHeight;e.width=i,e.height=s,this.addChild(e),this._left=this.createBitmapByName("left_png"),this._left.width=179,this._left.height=119,this._left.y=840,this._left.$setVisible(!1),this.addChild(this._left),this._right=this.createBitmapByName("right_png"),this._right.width=179,this._right.height=119,this._right.x=179,this._right.y=840,this._right.$setVisible(!1),this.addChild(this._right),this._btn=this.createBitmapByName("btn_zhua1_png"),this._btn.width=241,this._btn.height=159,this._btn.x=370,this._btn.y=815,this._btn.$setVisible(!1),this.addChild(this._btn),this._start=this.createBitmapByName("btn_start_png"),this._start.width=367,this._start.height=119,this._start.x=140,this._start.y=835,this.addChild(this._start),this._dot=new egret.Shape,this._dot.graphics.beginFill(65280),this._dot.graphics.drawCircle(0,0,5),this._dot.graphics.endFill()},e.prototype.launchCollisionTest=function(){},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var Test=function(t){function e(){var e=t.call(this)||this;return e.once(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){var e=new egret.ImageLoader;e.once(egret.Event.COMPLETE,this.imgLoadHandler,this),e.load("resource/assets/cartoon-egret_00.png")},e.prototype.imgLoadHandler=function(t){var e=t.currentTarget.data,i=new egret.Bitmap(e);i.x=100,i.y=100,this.addChild(i),i.anchorOffsetX=e.width/2,i.anchorOffsetY=e.height/2,i.x=.5*this.stage.stageWidth,i.y=.5*this.stage.stageHeight,this._txInfo=new egret.TextField,this.addChild(this._txInfo),this._txInfo.size=28,this._txInfo.x=50,this._txInfo.y=50,this._txInfo.textAlign=egret.HorizontalAlign.LEFT,this._txInfo.textColor=0,this._txInfo.type=egret.TextFieldType.DYNAMIC,this._txInfo.lineSpacing=6,this._txInfo.multiline=!0,this._txInfo.text="轻触屏幕调整显示对象位置",this._bgInfo=new egret.Shape,this.addChildAt(this._bgInfo,this.numChildren-1),this._bgInfo.x=this._txInfo.x,this._bgInfo.y=this._txInfo.y,this._bgInfo.graphics.clear(),this._bgInfo.graphics.beginFill(16777215,.5),this._bgInfo.graphics.drawRect(0,0,this._txInfo.width,this._txInfo.height),this._bgInfo.graphics.endFill(),this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){i.x=t.localX,i.y=t.localY},this)},e}(egret.DisplayObjectContainer);__reflect(Test.prototype,"Test");var Test2=function(t){function e(){var e=t.call(this)||this;return e.once(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){var e=new egret.ImageLoader;e.once(egret.Event.COMPLETE,this.imgLoadHandler,this),e.load("resource/assets/cartoon-egret_03.png")},e.prototype.launchMask=function(){this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchHandler,this)},e.prototype.updateBird=function(t,e){this._bird.x=t,this._bird.y=e},e.prototype.touchHandler=function(t){switch(t.type){case egret.TouchEvent.TOUCH_MOVE:this.updateBird(t.stageX,t.stageY);break;case egret.TouchEvent.TOUCH_BEGIN:this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchHandler,this),this.stage.once(egret.TouchEvent.TOUCH_END,this.touchHandler,this),this._shpBeMask.mask=this._bird,this.updateBird(t.stageX,t.stageY);break;case egret.TouchEvent.TOUCH_END:this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchHandler,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchHandler,this),this._shpBeMask.mask=null,this._bird.$maskedObject=null}},e.prototype.imgLoadHandler=function(t){this._shpBeMask=new egret.Shape,this._shpBeMask.graphics.lineStyle(0),this._shpBeMask.graphics.beginFill(this.getRdmClr()),this._shpBeMask.graphics.drawEllipse(0,0,200,300),this._shpBeMask.graphics.endFill(),this._shpBeMask.x=(this.stage.stageWidth-200)/2,this._shpBeMask.y=(this.stage.stageHeight-300)/2,this.addChild(this._shpBeMask),this._bird=new egret.Bitmap(t.currentTarget.data);var e=this._bird.width/2,i=this._bird.height/2;this._bird.anchorOffsetX=e,this._bird.anchorOffsetY=i,this._bird.x=e+(this.stage.stageWidth-2*e)*Math.random(),this._bird.y=i+(this.stage.stageHeight-2*i)*Math.random(),this.addChild(this._bird),this._txInfo=new egret.TextField,this.addChildAt(this._txInfo,0),this._txInfo.size=28,this._txInfo.x=50,this._txInfo.y=50,this._txInfo.width=this.stage.stageWidth-100,this._txInfo.textAlign=egret.HorizontalAlign.LEFT,this._txInfo.textColor=0,this._txInfo.type=egret.TextFieldType.DYNAMIC,this._txInfo.lineSpacing=6,this._txInfo.multiline=!0,this._txInfo.touchEnabled=!0,this._txInfo.text="接触屏幕后白鹭小鸟将变为椭圆形状的遮罩区域，可以移动手指（白鹭小鸟）并观察椭圆在遮罩下的显示变化",this.launchMask()},e.prototype.getRdmClr=function(){return(Math.floor(255*Math.random())<<16)+(Math.floor(255*Math.random())<<8)+Math.floor(255*Math.random())},e}(egret.DisplayObjectContainer);__reflect(Test2.prototype,"Test2");